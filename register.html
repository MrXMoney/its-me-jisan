<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>রেজিস্ট্রেশন - i-Bank BD</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
</head>
<body class="bg-gray-100">
  <div class="max-w-md mx-auto mt-10 bg-white p-6 rounded shadow">
    <h2 class="text-2xl font-bold text-center mb-4">নতুন একাউন্ট খুলুন</h2>
    <input id="name" type="text" placeholder="নাম" class="w-full border p-2 mb-2 rounded" />
    <input id="phone" type="text" placeholder="মোবাইল নম্বর (ex: 01XXXXXXXXX)" class="w-full border p-2 mb-2 rounded" />
    <input id="password" type="password" placeholder="পাসওয়ার্ড" class="w-full border p-2 mb-2 rounded" />
    <input id="gmail" type="email" placeholder="জিমেইল (ঐচ্ছিক)" class="w-full border p-2 mb-2 rounded" />
    <input id="pin" type="password" maxlength="5" placeholder="৪-৫ ডিজিটের সিক্রেট পিন" class="w-full border p-2 mb-4 rounded" />
    <button onclick="register()" class="w-full bg-blue-600 text-white py-2 rounded">রেজিস্টার করুন</button>
    <p class="text-center mt-4 text-sm">অ্যাকাউন্ট আছে? <a href="login.html" class="text-blue-600">লগইন করুন</a></p>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDdQuA4izCiIYWJ3hNWLHVbglW5Ig2DHrM",
      authDomain: "i-bank-bd.firebaseapp.com",
      projectId: "i-bank-bd",
      storageBucket: "i-bank-bd.firebasestorage.app",
      messagingSenderId: "815383083283",
      appId: "1:815383083283:web:6ea26839b3a0bf22a982e6",
      measurementId: "G-CQWXB3KLWJ"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    function register() {
      const name = document.getElementById("name").value;
      const phone = document.getElementById("phone").value;
      const password = document.getElementById("password").value;
      const gmail = document.getElementById("gmail").value;
      const pin = document.getElementById("pin").value;

      if (!name || !phone || !password || !pin) {
        alert("সকল তথ্য পূরণ করুন।");
        return;
      }

      const email = phone + "@i-bank.bd"; // কাস্টম ইমেইল বানাচ্ছি Firebase Auth এর জন্য

      auth.createUserWithEmailAndPassword(email, password)
        .then((userCredential) => {
          const uid = userCredential.user.uid;
          return db.collection("users").doc(uid).set({
            name,
            phone,
            gmail: gmail || "",
            secretPin: pin,
            approved: false,
            balance: 0
          });
        })
        .then(() => {
          alert("রেজিস্ট্রেশন সফল হয়েছে! এডমিন অনুমোদনের পর লগইন করুন।");
          window.location.href = "login.html";
        })
        .catch((error) => {
          alert("ভুল হয়েছে: " + error.message);
        });
    }
  </script>
</body>
</html>
